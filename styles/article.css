article {
	--figure-margin-bottom: 200px;
	--line-height-body: 30px;

	display: contents;
}
article > * {
	grid-column: 1 / -1;
}

/* article cover */
article > header {
	grid-column: content-left / content-right;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	align-items: baseline;
	margin-bottom: var(--figure-margin-bottom);
}
article > header h1,
article > header p {
	max-width: 32rem;
}
article > header h1 {
	margin-bottom: var(--line-height-display);
}
article > header p {
	font-size: var(--font-size-section_title);
	line-height: var(--line-height-section_title);
	margin-top: 20px;
}
article > header img {
	width: 100%;
	background-color: var(--paper-yellow-shade);
}

/* roles section */
article #roles {
	display: flex;
	align-items: baseline;
	gap: var(--column-gap);
	margin-top: 30px;
	padding: 10px 0;
	border-top: 1px solid var(--black);
}
article #roles ul {
	display: flex;
}
article #roles li {
	font-family: "Fanwood Text Italic", "Fanwood Text";
	line-height: var(--line-height-body);
}
article #roles li::before {
	/* override global list style */
	content: '';
}
article #roles li:not(:first-child)::before {
	content: '·';
	position: static;
	margin: 0 8px;
}

/* article body */
article > * {
	grid-column: article-left / article-right;
	margin: 0;
}
article > * + * {
	margin-top: var(--line-height-body);
}
article > header + * {
	margin-top: 0; /* collapse margin of first element after cover */
}
article h2 {
	font-family: "Fanwood Text Italic", "Fanwood Text";
	font-size: var(--font-size-display_list_title);
	line-height: var(--line-height-display_list_title);
	text-align: center;
	--min-vmargin: calc(3 * var(--line-height-display_list_title));
	--max-vmargin: 240px;
	margin: clamp(var(--min-vmargin), 25vh, var(--max-vmargin)) 0;
}
article h2::before {
	content: "§";
	display: block;
	font-size: var(--font-size-display);
	line-height: var(--line-height-display);
	margin-bottom: 40px;
}
article h2 + h3 {
	margin-top: 0; /* collapse h3 margin if immediately after h2 */
}
article h3 {
	font-family: "Fanwood Text Italic", "Fanwood Text";
	font-size: var(--font-size-section_title);
	line-height: var(--line-height-section_title);
	justify-self: start;
	border-top: 1px solid var(--black);
	margin-top: 200px;
	padding-top: 20px;
}
article h3 + * {
	margin-top: 100px;
}
article ul {
	list-style-type: none;
}
article li {
	position: relative;
}
article li::before {
	content: '•';
	position: absolute;
	right: 100%;
	margin-right: 1ch;
}

/* figures */
article > figure {
	/* default width if not specified inline */
	--ideal-figure-column-count: 6;
	/* make narrower only when available columns are fewer than ideal */
	--figure-column-count: min(var(--ideal-figure-column-count), var(--column-count));

	--figure-column-offset: calc((var(--figure-column-count) - var(--article-column-count)) / 2);
	grid-column-start: flexible-left calc(-1 - var(--figure-column-offset));
	grid-column-end: flexible-right calc(1 + var(--figure-column-offset));

	display: grid;
	grid-template-columns: [bound-left] repeat(var(--figure-column-count), minmax(0, 1fr)) [bound-right];
	gap: var(--column-gap);
	align-items: end;
	margin-top: 150px;
}
article figure + *:not(h2, h3) {
	margin-top: var(--figure-margin-bottom);
}
article figure img, 
article figure video {
	--min-column-span: 2;
	--column-deficit: calc(
		var(--ideal-figure-column-count) - 
		min(var(--ideal-figure-column-count), var(--column-count))
	);
	/* figures w/ ideal span shrink by 1 column as figure area narrows by 2 */
	--column-span: max(
		calc(var(--ideal-span) - var(--column-deficit) / 2),
		var(--min-column-span)
	);
	/* if ideal span is not given, default to all columns available */
	grid-column-end: span var(--column-span, var(--figure-column-count));
	max-width: 100%;
}
article figure .key-figure {
	--min-column-span: 3;
}
@media (width < 600px) {
	article figure .key-figure {
		grid-column-end: span min(4, var(--ideal-span));
	}
}

/* captions */
article figure figcaption {
	font-size: var(--font-size-label);
	line-height: var(--line-height-label);
	grid-column: bound-left / bound-right;
	max-width: 48em;
}
article figure figcaption::before {
	font-variant: all-small-caps;
	margin-right: var(--column-gap);
	width: 2.25rem;
	display: inline-block;
	position: absolute;
	left: 0;
}
article figure.multi-caption > figure {
	display: contents;
}
article figure.multi-caption img {
	order: 1;
}
article figure.multi-caption figcaption {
	order: 2;
	position: relative;
	padding-left: 3.25rem;
}
article figure.multi-caption figure:not(:last-of-type) figcaption {
	margin-bottom: calc(-1 * var(--column-gap));
}
article figure.multi-caption figure:first-of-type figcaption::before {
	content: 'Left';
}
article figure.multi-caption figure:last-of-type figcaption::before {
	content: 'Right';
}

/* special layouts */
article figure.two-one {
	--ideal-figure-column-count: 12;
	/* extend figure grid to accommodate full bleed image */
	grid-column: 1 / -1;
	grid-template-columns: var(--wide-page-margin) [bound-left] repeat(var(--figure-column-count), minmax(0, 1fr)) [bound-right] var(--wide-page-margin);
	grid-auto-flow: column;
}
article figure.two-one img {
	grid-column-start: bound-left;
	/* crop image edges for alignment */
	align-self: stretch;
	object-fit: cover;
}
article figure.two-one img:nth-of-type(3) {
	grid-column-start: calc(var(--figure-column-count) / 2 + 2);
	grid-column-end: -1; /* full bleed */
	grid-row-end: span 2;
	width: auto;
}
@media (width < 600px) {
	article figure.two-one img:nth-of-type(3) {
		grid-column: bound-left / bound-right;
	}
}

article figure.caption-side figcaption {
	grid-column: auto / span 3;
	min-width: 14em;
}
@media (width < 850px) {
	article figure.caption-side figcaption {
		grid-column: bound-left / bound-right;
	}
}

/* end mark decoration */
article::after {
	content: "*";
	display: block;
	font-size: 40px;
	line-height: 1;
	grid-column: 1 / -1;
	margin: 200px auto;
}

/* angled background accents */
article * {
	position: relative;
}
article > header::before,
article > h2 ~ figure::before {
	content: '';
	display: block;
	position: absolute;
	background-color: var(--paper-yellow-shade);
	z-index: -1;
	width: 100vw;
	margin-left: calc(max(100vw - 100%, 0px) * -0.5);
}
article > header::before {
	transform: skewY(-15deg);
	top: calc(5 * var(--line-height-display));
	bottom: calc(-0.5 * var(--figure-margin-bottom));
}
/* add background for figures only after first section break */
article > h2 ~ figure::before {
	transform: skewY(15deg);
	top: 0;
	bottom: calc(-0.75 * var(--figure-margin-bottom));
}
